<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI创意工坊 - 儿童版</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <nav class="navbar">
            <div class="nav-brand">
                <i class="fas fa-magic"></i>
                <span>AI创意工坊</span>
            </div>
            <ul class="nav-menu">
                <li><a href="#home" class="nav-link active">首页</a></li>
                <li><a href="#upload" class="nav-link">上传作品</a></li>
                <li><a href="/gallery" class="nav-link">作品展示</a></li>
                <li><a href="/tutorial" class="nav-link">使用教程</a></li>
            </ul>
            <div class="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <main>
        <!-- 首页介绍 -->
        <section id="home" class="hero">
            <div class="hero-content">
                <h1 class="hero-title">欢迎来到AI创意工坊！</h1>
                <p class="hero-subtitle">用文字描述或上传线稿，AI帮你创造精美作品！</p>
                <div class="creation-flow">
                    <div class="flow-steps">
                        <div class="flow-step">
                            <div class="step-icon">📝</div>
                            <div class="step-text">输入描述 + 上传图片</div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">
                            <div class="step-icon">🎨</div>
                            <div class="step-text">AI生成图片</div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">
                            <div class="step-icon">✏️</div>
                            <div class="step-text">调整完善</div>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">
                            <div class="step-icon">🧊</div>
                            <div class="step-text">生成3D模型</div>
                        </div>
                    </div>
                    <button class="start-creation-btn" onclick="startCreation()">
                        <i class="fas fa-magic"></i>
                        开始创作
                    </button>
                </div>
            </div>
        </section>

        <!-- 统一创作界面 -->
        <section id="creation-workspace" class="creation-section" style="display: none;">
            <div class="container">
                <div class="back-to-home">
                    <button onclick="backToHome()" class="back-btn">
                        <i class="fas fa-arrow-left"></i>
                        返回首页
                    </button>
                </div>
                <h2 class="section-title">
                    <i class="fas fa-magic"></i>
                    AI创意工坊
                </h2>
                <p class="section-subtitle">文字描述 + 图片上传，让AI理解你的创意！</p>
                
                <!-- 创作输入区域 -->
                <div class="creation-input-area">
                    <div class="prompt-input-container">
                        <label for="creation-prompt">
                            <i class="fas fa-lightbulb"></i>
                            描述你的创意
                        </label>
                        <div class="input-wrapper">
                            <textarea 
                                id="creation-prompt" 
                                class="creation-input" 
                                placeholder="例如：一只可爱的小猫咪，戴着红色的帽子，坐在彩虹上...&#10;&#10;你可以只用文字描述，也可以上传图片作为参考！"
                                rows="4"
                            ></textarea>
                            <button class="add-image-btn" onclick="triggerImageUpload()" title="上传参考图片">
                                <i class="fas fa-plus"></i>
                            </button>
                            <input type="file" id="reference-image" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
                        </div>
                        <div class="input-hint">
                            💡 <strong>创作小贴士：</strong>可以描述颜色、形状、表情、背景等细节，或上传线稿图片
                        </div>
                    </div>

                    <!-- 上传的图片预览 -->
                    <div id="uploaded-image-preview" class="image-preview" style="display: none;">
                        <div class="preview-header">
                            <span><i class="fas fa-image"></i> 参考图片</span>
                            <button class="remove-image-btn" onclick="removeUploadedImage()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <img id="uploaded-image" src="" alt="上传的参考图片">
                    </div>
                    
                    <div class="generation-options">
                        <div class="option-group">
                            <label>图片风格：</label>
                            <select id="image-style" class="style-select">
                                <option value="cute">可爱卡通</option>
                                <option value="realistic">写实风格</option>
                                <option value="anime">动漫风格</option>
                                <option value="fantasy">奇幻风格</option>
                            </select>
                        </div>
                        <div class="option-group">
                            <label>色彩偏好：</label>
                            <select id="color-preference" class="style-select">
                                <option value="colorful">色彩丰富</option>
                                <option value="pastel">柔和色调</option>
                                <option value="bright">明亮鲜艳</option>
                                <option value="natural">自然色彩</option>
                            </select>
                        </div>
                    </div>
                    
                    <button id="generate-image" class="generate-btn">
                        <i class="fas fa-wand-magic-sparkles"></i>
                        生成图片
                    </button>
                </div>

                <!-- 生成结果区域 -->
                <div id="generation-result" class="result-area" style="display: none;">
                    <h3 class="result-title">
                        <i class="fas fa-image"></i>
                        AI生成结果
                    </h3>
                    
                    <div class="generated-image-container">
                        <img id="generated-image" src="" alt="AI生成的图片">
                        <div class="image-actions">
                            <button class="action-btn regenerate-btn" onclick="regenerateImage()">
                                <i class="fas fa-redo"></i>
                                重新生成
                            </button>
                            <button class="action-btn adjust-btn" onclick="showAdjustPanel()">
                                <i class="fas fa-sliders-h"></i>
                                调整图片
                            </button>
                            <button class="action-btn confirm-btn" onclick="confirmAndGenerate3D()">
                                <i class="fas fa-cube"></i>
                                确认并生成3D
                            </button>
                        </div>
                    </div>

                    <!-- 调整面板 -->
                    <div id="adjust-panel" class="adjust-panel" style="display: none;">
                        <h4><i class="fas fa-edit"></i> 调整提示</h4>
                        <textarea 
                            id="adjustment-prompt" 
                            class="adjustment-input" 
                            placeholder="例如：让颜色更鲜艳一些，改变背景为森林..."
                            rows="3"
                        ></textarea>
                        <div class="adjust-actions">
                            <button class="apply-adjust-btn" onclick="applyAdjustment()">
                                <i class="fas fa-check"></i>
                                应用调整
                            </button>
                            <button class="cancel-adjust-btn" onclick="hideAdjustPanel()">
                                <i class="fas fa-times"></i>
                                取消
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 3D生成结果区域 -->
                <div id="model-generation-result" class="model-result-area" style="display: none;">
                    <h3 class="result-title">
                        <i class="fas fa-cube"></i>
                        3D模型生成完成！
                    </h3>
                    
                    <div class="final-results-grid">
                        <!-- 最终图片 -->
                        <div class="final-result-item">
                            <h4>最终图片</h4>
                            <div class="image-container">
                                <img id="final-image" src="" alt="最终确认的图片">
                            </div>
                            <button class="download-btn" onclick="downloadImage()">
                                <i class="fas fa-download"></i>
                                下载图片
                            </button>
                        </div>
                        
                        <!-- 3D模型预览 -->
                        <div class="final-result-item model-preview">
                            <h4>3D模型预览</h4>
                            <div class="model-container" id="modelContainer">
                                <!-- Three.js 3D模型将在这里渲染 -->
                                <div class="model-placeholder">
                                    <i class="fas fa-cube"></i>
                                    <p>3D模型加载中...</p>
                                </div>
                            </div>
                            <div class="model-controls">
                                <button class="control-btn" id="rotateModel">
                                    <i class="fas fa-sync-alt"></i>
                                    自动旋转
                                </button>
                                <button class="download-btn" id="download3D">
                                    <i class="fas fa-download"></i>
                                    下载3D模型
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="final-actions">
                        <button class="secondary-btn" onclick="startNewCreation()">
                            <i class="fas fa-plus"></i>
                            创建新作品
                        </button>
                        <button class="primary-btn" onclick="shareCreation()">
                            <i class="fas fa-share"></i>
                            分享我的创作
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>关于我们</h4>
                    <p>AI创意工坊致力于让儿童通过有趣的方式学习和体验AI技术。</p>
                </div>
                <div class="footer-section">
                    <h4>功能特色</h4>
                    <ul>
                        <li>简笔画智能上色</li>
                        <li>3D模型自动生成</li>
                        <li>手办风格转换</li>
                        <li>AI技术学习</li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>联系我们</h4>
                    <p>如有问题或建议，请联系我们的技术支持团队。</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 AI创意工坊. 专为10-14岁儿童设计.</p>
            </div>
        </div>
    </footer>

    <!-- 加载Three.js用于3D模型展示 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    
    <!-- 主要JavaScript文件 -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>